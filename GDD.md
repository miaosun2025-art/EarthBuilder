# 游戏设计文档 (GDD)
## 《地球新主》(EarthBuilder)

---

## 文档信息
- **游戏名称**: 地球新主 (EarthBuilder)
- **游戏类型**: 末世生存 + LBS探索 + 建造管理 + 社交交易
- **平台**: iOS
- **目标受众**: 18-40岁，喜欢策略、生存、探索的玩家
- **文档版本**: v1.0
- **最后更新**: 2026-01-03

---

## 1. 游戏概念

### 1.1 高概念 (High Concept)
**"用脚步丈量你的王国，在废墟上重建文明"**

《地球新主》是一款将真实世界与虚拟游戏深度融合的末世生存游戏。玩家通过真实的GPS移动来圈占领地、探索废墟、收集资源，并在自己的领地上建造设施，与其他玩家交易互动，共同在末世废土上重建人类文明。

### 1.2 核心玩法 (Core Gameplay)
- **走路圈地**: 用GPS轨迹圈占真实世界的土地，成为你的虚拟领地
- **探索搜刮**: 走到真实地标 (医院、超市等) 搜刮资源
- **建造发展**: 用资源在领地上建造建筑，发展你的基地
- **生存挑战**: 管理饱食度、水分等生存指标，保持角色存活
- **社交互动**: 与附近玩家交易、聊天、组建联盟

### 1.3 游戏世界观

**时间线**:
- 2048年: "世界战争"爆发，全球文明在72小时内崩塌，99%人口消失
- 2051年: 幸存者从避难所走出，新秩序《新开拓者协议》诞生
- 玩家时间: 2051年后，作为开拓者重建文明

**核心法则**:
> "凡以双足丈量之无主土地，皆为开拓者所有。"
> —— 《新开拓者协议》第一章

**视觉风格**: 希望朋克 (Hopepunk)
- 废土背景中的新生与希望
- 破败建筑上的绿色植物
- 温暖的光线和鲜艳的标识色
- 对比鲜明: 灰暗的废墟 vs 明亮的新建筑

**情感基调**:
- 不是绝望的末日，而是充满希望的重建
- 强调合作而非对抗
- 每一步行动都是在为新世界添砖加瓦

---

## 2. 核心游戏循环 (Core Loop)

### 2.1 短期循环 (5-15分钟)
```
出门探索 → 发现POI → 搜刮资源 → 返回领地 → 使用资源 (建造/交易/补给)
```

### 2.2 中期循环 (每日)
```
每日登录 → 查看生存体征 → 补充食物/水 → 完成每日任务 → 查看排行榜 → 建造/升级建筑 → 与其他玩家交易
```

### 2.3 长期循环 (每周/每月)
```
扩大领地 → 完成成就 → 升级设备 → 参与活动 → 提升排名 → 建立联盟 → 成为区域领主
```

### 2.4 核心循环图示

```
┌─────────────────────────────────────────────────────────────┐
│                     核心游戏循环                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   1. 圈地占领 ──→ 拥有领地 (游戏基础)                        │
│         ↓                                                   │
│   2. 探索搜刮 ──→ 获得资源 (行动驱动)                        │
│         ↓                                                   │
│   3. 资源用途:                                               │
│      • 建造建筑 (发展领地)                                    │
│      • 交易换物 (社交互动)                                    │
│      • 维持生存 (消耗循环)                                    │
│         ↓                                                   │
│   4. 成长发展 ──→ 等级↑ 排名↑ 成就↑                         │
│         ↓                                                   │
│   5. 社交通讯 ──→ 频道聊天、PTT呼叫、联盟协作                │
│         ↓                                                   │
│   └─────→ 重复循环，持续成长                                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. 核心系统设计

### 3.1 圈地系统 (Territory System)

#### 3.1.1 玩法机制
**目标**: 通过GPS移动圈占真实世界的土地

**操作流程**:
1. 点击"开始圈地"
2. 实时GPS定位，记录移动轨迹
3. 轨迹在地图上显示为蓝色路径
4. 走回起点附近 (50米内)，轨迹自动闭合成多边形
5. 系统验证合法性
6. 验证通过，领地归属玩家

**合法性验证**:
- 最小面积: 500m² (避免恶意小圈)
- 最大面积: 无上限 (鼓励探索)
- 重叠检测: 不能与其他玩家领地重叠
- 防作弊检测:
  - 速度异常: 移动速度 > 20km/h 视为作弊
  - 轨迹异常: 直线距离与实际距离差异过大
  - 时间异常: 圈地时长 < 5分钟视为异常

**领地属性**:
- **名称**: 玩家自定义，50字符内
- **面积**: 自动计算 (平方米)
- **创建时间**: 记录圈地时间
- **建筑数量**: 当前已建造的建筑数
- **状态**: 活跃/待建设/废弃

**领地限制**:
- 每个玩家最多拥有 **5块领地** (可通过VIP扩展)
- 新圈的领地需在30天内建造第一个建筑，否则回收
- 90天内未登录，领地自动回收

**设计意图**:
- **鼓励运动**: 圈地需要真实移动，自然鼓励户外活动
- **策略选择**: 圈大圈小各有利弊 (大圈难建造，小圈资源少)
- **地理探索**: 玩家会寻找合适的圈地地点 (公园、空地等)
- **防止垄断**: 重叠限制保证公平性

---

### 3.2 探索搜刮系统 (Exploration & Scavenging)

#### 3.2.1 POI发现机制

**POI (兴趣点) 类型与资源对应表**:

| POI类型 | 对应场所 | 掉落资源 | 稀有度 |
|---------|----------|----------|--------|
| 医疗设施 | 医院、诊所、药店 | 药品 (急救包、抗生素) | 稀有 |
| 食品场所 | 超市、餐厅、食品店 | 食物 (罐头、饮用水) | 常见 |
| 工业设施 | 工厂、工地、仓库 | 金属、工具 | 常见 |
| 自然场所 | 公园、森林、绿地 | 木材、布料 | 常见 |
| 金融机构 | 银行、珠宝店 | 稀有材料 (卫星模块) | 超稀有 |
| 能源设施 | 加油站、电厂 | 能源组件 | 稀有 |
| 建筑废墟 | 废弃建筑 | 石头、建材 | 常见 |

**触发机制**:
- **地理围栏**: 进入POI 100米范围内自动触发提示
- **搜刮冷却**: 同一POI 24小时内只能搜刮一次
- **个人冷却**: 玩家每天最多搜刮 **20个POI** (VIP无限制)

#### 3.2.2 搜刮掉落设计

**掉落公式**:
```
掉落数量 = 基础掉落 × POI稀有度系数 × 玩家等级系数 × 随机系数

随机系数 = 0.8 - 1.2 (上下浮动20%)
玩家等级系数 = 1 + (玩家等级 × 0.02)  // 等级10 = 1.2倍
POI稀有度系数:
  - 常见POI: 1.0
  - 稀有POI: 1.5
  - 超稀有POI: 2.0
```

**掉落示例**:
- **超市** (常见):
  - 罐头食品: 15-25个
  - 饮用水: 10-20个
  - 布料: 5-10个
- **医院** (稀有):
  - 药品: 10-15个
  - 急救包: 3-5个
  - 绷带: 8-12个
- **银行** (超稀有):
  - 卫星模块: 1-3个
  - 稀有材料: 5-10个
  - 金属: 20-30个

**探索奖励**:
- 探索距离记录 (累计里程)
- 探索时长记录
- 首次发现奖励 (首次搜刮某类POI +50% 掉落)
- 探索成就解锁

**设计意图**:
- **Walk to Earn**: 走路越多，资源越多
- **地理探索**: 不同地点产出不同资源，鼓励玩家探索城市
- **稀缺性**: 稀有资源只能在特定地点获得，增加策略性
- **每日限制**: 防止刷资源，保持游戏平衡

---

### 3.3 资源与背包系统

#### 3.3.1 资源分类

**基础资源 (Tier 1)**:
- **食物**: 罐头食品、饮用水、干粮
- **材料**: 木材、石头、布料
- **基础金属**: 铁、铜

**进阶资源 (Tier 2)**:
- **药品**: 急救包、抗生素、绷带
- **工具**: 扳手、锤子、电锯
- **合金**: 钢材、铝材

**稀有资源 (Tier 3)**:
- **电子元件**: 芯片、电路板
- **能源组件**: 太阳能板、电池
- **稀有材料**: 卫星模块、高级合金

#### 3.3.2 背包设计

**容量系统**:
- 初始容量: **100格**
- 扩容方式:
  - 建造仓库: 小仓库 +50, 中仓库 +100, 大仓库 +200
  - 购买背包升级: 每次 +20格，最多升级5次 (付费项)
  - VIP特权: 月卡 +50, 通行证 +100

**背包机制**:
- 每种物品占用1格 (不按数量)
- 可堆叠: 同类物品自动堆叠，显示数量
- 分类标签: 食物、材料、药品、工具、稀有
- 快速使用: 点击物品可直接使用 (食物/药品)

**本地优先架构**:
- 背包数据先存本地，离线可查看
- 联网时异步同步到云端
- 冲突解决: 以服务器数据为准

**设计意图**:
- **容量限制**: 制造稀缺感，玩家需策略管理资源
- **扩容动机**: 驱动玩家建造仓库或付费
- **快速使用**: 优化生存体征的补给体验

---

### 3.4 建造系统

#### 3.4.1 建筑分类与功能

**生存类建筑**:
| 建筑名称 | 等级 | 功能 | 建造成本 | 建造时长 |
|----------|------|------|----------|----------|
| 篝火 | T1 | 提供温暖，减缓生命值下降 | 石头×20, 木材×30 | 5分钟 |
| 帐篷 | T1 | 休息恢复，加速生命值回复 | 布料×30, 木材×20 | 10分钟 |
| 庇护所 | T2 | 高级休息，自动恢复生存体征 | 木材×100, 金属×50, 布料×50 | 30分钟 |
| 安全屋 | T3 | 完全恢复，储存物资 | 金属×200, 混凝土×150, 电子元件×10 | 2小时 |

**储存类建筑**:
| 建筑名称 | 等级 | 功能 | 扩容量 | 建造成本 |
|----------|------|------|--------|----------|
| 小仓库 | T1 | 扩展背包容量 | +50格 | 木材×50, 石头×30 |
| 中仓库 | T2 | 扩展背包容量 | +100格 | 木材×100, 金属×80 |
| 大仓库 | T3 | 扩展背包容量 | +200格 | 金属×200, 混凝土×150 |

**生产类建筑**:
| 建筑名称 | 等级 | 功能 | 产出 | 建造成本 |
|----------|------|------|------|----------|
| 农田 | T1 | 定期产出食物 | 食物×10/天 | 木材×40, 种子×20 |
| 工作台 | T1 | 合成物品 | 手动合成 | 木材×60, 金属×30 |
| 水井 | T2 | 定期产出饮用水 | 水×20/天 | 石头×100, 工具×10 |
| 熔炉 | T2 | 冶炼金属 | 合金 | 石头×150, 金属×80 |
| 工厂 | T3 | 自动生产资源 | 全资源×5/天 | 金属×300, 电子元件×20 |

**能源类建筑**:
| 建筑名称 | 等级 | 功能 | 产出 | 建造成本 |
|----------|------|------|------|----------|
| 太阳能板 | T2 | 提供电力 | 电力×50/天 | 金属×100, 电子元件×15 |
| 风力发电机 | T2 | 提供电力 | 电力×80/天 | 金属×150, 电子元件×20 |
| 发电站 | T3 | 大量电力 | 电力×300/天 | 金属×400, 稀有材料×30 |

#### 3.4.2 建造流程

```
选择建筑 → 检查资源 → 资源充足?
  ├─ 否 → 提示不足，引导探索/交易
  └─ 是 → 选择位置 → 确认建造 → 扣除资源 → 进入建造状态
        → 等待建造时长 → 建造完成 → 进入"待激活"状态
```

**建造限制**:
- **领地容量**: 领地面积决定可建造数量
  - 1000m² = 最多5个建筑
  - 每增加1000m²，可建造数 +3
- **建筑间距**: 建筑之间至少间隔10米 (防止重叠)
- **地形限制**: 不能建在领地边界外

**加速机制**:
- 免费加速: 观看广告减少10%时长
- 付费加速: 使用"建造加速卡"或宝石立即完成
- VIP特权: 领主通行证建造时间减半

#### 3.4.3 建筑状态机

```
状态流转:
建造中 → 待激活 → 运行中 ⇄ 损坏 → 维修中 → 运行中
                    ↓
                  拆除
```

**状态说明**:
- **建造中**: 倒计时，无法使用
- **待激活**: 建造完成，需手动激活 (消耗少量资源)
- **运行中**: 正常工作，产出资源
- **损坏**: 耐久度归零，停止工作
- **维修中**: 修复中，消耗资源和时间

**耐久度机制**:
- 每个建筑有耐久度 (100点)
- 每24小时自动减少5点 (生产类建筑减少10点)
- 耐久度归零 → 进入"损坏"状态
- 维修成本 = 建造成本 × 30%

**设计意图**:
- **资源消耗循环**: 建筑需要持续维护，形成资源消耗出口
- **策略选择**: 玩家需权衡建造数量和维护成本
- **付费动机**: 加速和VIP提供便利

---

### 3.5 交易系统

#### 3.5.1 交易机制

**挂单系统**:
- 玩家发布交易挂单:
  - 我提供: 罐头食品 × 50
  - 我需要: 药品 × 10
- 挂单限制: 每人最多同时挂 **5个订单** (VIP 10个)

**匹配规则**:
- **位置限制**: 只有进入对方领地 **100米范围内** 才能看到挂单
- **交易开关**: 领地主人需开启"允许交易"
- **资源检查**: 交易时自动检查双方资源是否充足

**交易流程**:
```
A发布挂单 → B进入A领地100米内 → B看到A的挂单列表
→ B选择接受某个挂单 → 系统检查资源 → 双方资源充足?
  ├─ 否 → 交易失败，提示资源不足
  └─ 是 → 自动扣除和发放物品 → 交易成功 → 双方收到通知
```

**交易记录**:
- 记录交易历史 (时间、对方、物品、数量)
- 交易统计 (总交易次数、总价值)
- 解锁成就 (首次交易、交易达人等)

#### 3.5.2 交易经济设计

**资源价值体系** (参考汇率):
| 资源 | 价值 | 兑换比例 |
|------|------|----------|
| 罐头食品 | 1 | 基准 |
| 饮用水 | 1.2 | 1水 = 1.2罐头 |
| 木材 | 0.8 | 1木材 = 0.8罐头 |
| 金属 | 1.5 | 1金属 = 1.5罐头 |
| 药品 | 3 | 1药品 = 3罐头 |
| 稀有材料 | 10 | 1稀有 = 10罐头 |

**供需平衡**:
- 系统不参与交易，完全由玩家自由定价
- 通过POI掉落率控制供给
- 通过建造需求和生存消耗控制需求

**防刷机制**:
- 禁止同一IP的两个账号交易 (防小号刷资源)
- 交易冷却: 同一对玩家24小时内最多交易3次
- 异常监测: 高价值物品交易需人工审核

**设计意图**:
- **社交驱动**: 交易必须靠近，鼓励玩家在现实中移动和相遇
- **互利共赢**: 以物易物，各取所需
- **经济循环**: 形成玩家间的资源流动

---

### 3.6 生存体征系统

#### 3.6.1 生存指标设计

**三大核心指标**:
| 指标 | 初始值 | 最大值 | 衰减速度 | 补充方式 |
|------|--------|--------|----------|----------|
| 核心生命 | 100 | 100 | 不自动衰减* | 使用药品、在庇护所休息 |
| 饱食度 | 100% | 100% | -5% / 小时 | 食用食物 (罐头+20%, 干粮+10%) |
| 水分 | 100% | 100% | -10% / 小时 | 饮用水 (饮用水+25%, 净水+15%) |

*核心生命在饱食度或水分 < 30% 时开始衰减

**衰减公式**:
```
饱食度(当前) = 饱食度(上次) - (经过小时数 × 5%)
水分(当前) = 水分(上次) - (经过小时数 × 10%)

当饱食度 < 30% 或 水分 < 30%:
  生命值(当前) = 生命值(上次) - (经过小时数 × 2)
```

#### 3.6.2 状态 Buff/Debuff

**正面状态** (饱食度 & 水分 > 80%):
- **充沛状态**:
  - 探索掉落 +20%
  - 建造速度 +10%
  - 移动速度 (圈地) +15%
  - 持续时间: 直到指标降至80%以下

**负面状态**:
- **饥饿** (饱食度 < 30%):
  - 生命值持续下降 -2/小时
  - 探索掉落 -30%
  - 建造速度 -20%
- **脱水** (水分 < 30%):
  - 生命值持续下降 -3/小时
  - 移动速度 -30%
  - 视觉效果: 屏幕边缘发黄
- **濒死** (生命值 < 20):
  - 探索和建造功能禁用
  - 只能使用药品或在庇护所休息
  - 视觉效果: 屏幕边缘发红

**死亡惩罚**:
- 生命值归零 → 角色死亡
- 惩罚:
  - 背包随机掉落 20% 的物品
  - 当前位置生成"遗体包裹"，其他玩家可拾取
  - 重生需要消耗 100金币 或 等待2小时
- 重生点: 最近的领地或出生点

#### 3.6.3 补给设计

**食物补给**:
| 食物类型 | 饱食度恢复 | 获取方式 |
|----------|------------|----------|
| 罐头食品 | +20% | 搜刮超市 |
| 干粮 | +10% | 搜刮餐厅 |
| 新鲜食物 | +35% | 农田产出 (稀有) |

**水分补给**:
| 水类型 | 水分恢复 | 获取方式 |
|--------|----------|----------|
| 饮用水 | +25% | 搜刮超市 |
| 净水 | +15% | 搜刮加工厂 |
| 纯净水 | +40% | 水井产出 (稀有) |

**医疗补给**:
| 药品类型 | 生命值恢复 | 获取方式 |
|----------|------------|----------|
| 绷带 | +10 | 搜刮药店 |
| 急救包 | +30 | 搜刮医院 |
| 抗生素 | +50 + 移除debuff | 搜刮医院 (稀有) |

**设计意图**:
- **强制活跃**: 生存指标持续衰减，玩家必须定期登录补给
- **资源消耗**: 食物/水成为重要消耗品，驱动探索和交易
- **付费点**: 可售卖"速效补给包"快速恢复
- **风险奖励**: 充沛状态奖励鼓励玩家保持健康

---

### 3.7 通讯与社交系统

#### 3.7.1 通讯设备等级

**设备升级路径**:
| 等级 | 设备名称 | 功能 | 覆盖范围 | 升级成本 |
|------|----------|------|----------|----------|
| Lv.1 | 收音机 | 仅接收，不能发送 | 3km | 初始装备 |
| Lv.2 | 对讲机 | 可收发消息 | 3km | 金属×100, 电子元件×10 |
| Lv.3 | 营地电台 | 可收发消息、创建频道 | 10km | 金属×300, 电子元件×30, 能源×50 |
| Lv.4 | 卫星通讯 | 全球收发、无限频道 | 全球 | 稀有材料×50, 卫星模块×5 |

**设备限制**:
- Lv.1 (收音机): 只能听公共频道，不能发言
- Lv.2 (对讲机): 可发言，但只能加入3个频道
- Lv.3 (营地电台): 可创建频道，可加入10个频道
- Lv.4 (卫星通讯): 无限制

#### 3.7.2 频道系统

**公共频道**:
- 系统默认频道，所有玩家可见
- 覆盖范围: 3km (根据设备等级扩大)
- 消息保留: 最近100条
- 发言冷却: 10秒/条 (防刷屏)

**自建频道**:
- 需要营地电台以上设备
- 频道创建:
  - 频道名称 (20字内)
  - 频道描述 (100字内)
  - 位置绑定 (可选): 绑定到某个领地，只有附近玩家可见
  - 公开/私密: 私密频道需邀请码加入
- 频道管理:
  - 创建者为管理员
  - 可踢人、禁言
  - 可关闭频道

**频道列表**:
- 按距离排序 (最近的在前)
- 显示: 频道名、距离、在线人数、最后活跃时间
- 筛选: 全部/公开/私密/我加入的

#### 3.7.3 PTT呼叫系统

**Push to Talk (一键通话)**:
- 长按大麦克风按钮录音
- 松开自动发送
- 最长录音时长: 30秒
- 发送范围: 根据设备等级决定

**呼叫频率**:
- 438.000 MHz: 公共频道 (默认)
- 其他频率: 自建频道自动分配

**语音消息**:
- 自动播放 (可在设置中关闭)
- 播放时显示发送者昵称和波形动画
- 可重听

**设计意图**:
- **沉浸感**: 模拟真实无线电体验
- **即时通讯**: 比打字更快，适合紧急情况
- **社交破冰**: 语音比文字更有温度

---

### 3.8 成长与激励系统

#### 3.8.1 等级系统

**经验值获取**:
| 行为 | 经验值 |
|------|--------|
| 圈地 | 面积 ÷ 10 (1000m² = 100 EXP) |
| 搜刮POI | 20 EXP / 次 |
| 建造建筑 | 建筑等级 × 50 (T1=50, T2=100, T3=150) |
| 完成交易 | 30 EXP / 次 |
| 完成每日任务 | 100 EXP |
| 完成成就 | 根据成就稀有度 (50-500 EXP) |

**等级提升奖励**:
| 等级 | 奖励 |
|------|------|
| Lv.5 | 解锁交易功能 |
| Lv.10 | 背包容量 +20 |
| Lv.15 | 解锁营地电台升级 |
| Lv.20 | 领地上限 +1 (可拥有6块领地) |
| Lv.25 | 背包容量 +30 |
| Lv.30 | 解锁卫星通讯升级 |
| 每升级 | 金币 × 100, 随机资源包 |

**等级称号**:
- Lv.1-9: 新手幸存者
- Lv.10-19: 开拓者
- Lv.20-29: 领地主
- Lv.30-39: 区域领主
- Lv.40-49: 重建者
- Lv.50+: 文明引领者

#### 3.8.2 成就系统

**成就分类**:

**新手成就** (引导性):
- **初入废土**: 完成新手教程 → 奖励: 100金币
- **第一块领地**: 完成第一次圈地 → 奖励: 200金币, 木材×50
- **末世拾荒者**: 完成第一次搜刮 → 奖励: 150金币
- **建设者**: 建造第一个建筑 → 奖励: 200金币
- **商人**: 完成第一次交易 → 奖励: 150金币

**探索成就**:
- **城市探险家**: 搜刮50个不同POI → 500金币
- **废墟猎人**: 搜刮100次 → 800金币
- **长途跋涉**: 累计探索距离50km → 1000金币

**建造成就**:
- **小镇领主**: 建造10个建筑 → 600金币
- **城市规划师**: 建造30个建筑 → 1500金币
- **建筑大师**: 拥有所有类型的建筑 → 2000金币

**社交成就**:
- **初次相遇**: 与其他玩家交易1次 → 200金币
- **贸易达人**: 完成50次交易 → 800金币
- **频道之声**: 在频道发送100条消息 → 300金币

**稀有成就** (挑战性):
- **土地大亨**: 单次圈地面积超过50000m² → 3000金币, 稀有材料×10
- **生存专家**: 连续存活100天 → 5000金币, 专属称号
- **文明火种**: 帮助10个新手完成首次圈地 → 2000金币, 专属徽章

**设计意图**:
- **新手引导**: 用奖励引导玩家体验核心功能
- **长期目标**: 稀有成就给老玩家追求的目标
- **炫耀资本**: 专属称号和徽章满足荣誉感

#### 3.8.3 排行榜系统

**榜单分类**:
1. **领地面积榜**: 总领地面积排名 (Top 100)
2. **探索废墟榜**: 搜刮POI次数排名
3. **建筑数量榜**: 建造建筑总数排名
4. **财富榜**: 资源总价值排名 (未来)
5. **社交榜**: 交易次数排名 (未来)

**榜单机制**:
- 每5分钟更新一次
- 显示玩家头像、昵称、数值
- 自己的排名高亮显示
- 点击可查看对方档案 (基础信息)

**榜单奖励** (每周):
- 第1名: 5000金币, 稀有资源包, 专属称号(1周)
- 第2-10名: 2000金币, 高级资源包
- 第11-50名: 1000金币, 中级资源包
- 第51-100名: 500金币

**设计意图**:
- **竞争动力**: 排名激发玩家竞争欲
- **活跃提升**: 为了保住排名每天登录
- **社交传播**: 玩家会分享自己的排名

---

## 4. 数值平衡设计

### 4.1 资源平衡

**资源获取速度** (每日平均):
- 探索搜刮 (20次): 食物×300, 木材×150, 金属×80, 药品×40
- 建筑产出 (农田+水井): 食物×10, 水×20
- 交易获得: 根据玩家策略变化
- **总计**: 约满足1天生存 + 建造1-2个T1建筑

**资源消耗速度** (每日平均):
- 生存消耗: 食物×120 (饱食度), 水×240 (水分)
- 建造消耗: 根据建筑计划
- 维修消耗: 建筑耐久度维护
- **总计**: 刚好平衡，需要持续探索

**平衡原则**:
- 免费玩家: 每天1小时游玩可维持基本生存 + 少量发展
- 付费玩家: 通过月卡和资源包加速发展
- 资源应"略紧张但够用"，制造策略选择的压力

### 4.2 建造平衡

**建造时长设计**:
| 建筑等级 | 建造时长 | 设计意图 |
|----------|----------|----------|
| Tier 1 | 5-15分钟 | 即时满足感 |
| Tier 2 | 30分钟-2小时 | 引导玩家多次登录 |
| Tier 3 | 2-8小时 | 付费加速或等待 |

**建筑成本梯度**:
- T1 → T2: 成本 × 5, 产出 × 3
- T2 → T3: 成本 × 4, 产出 × 3
- 目的: 高级建筑性价比略低，但有独特功能

### 4.3 生存平衡

**生存时长设计**:
- 饱食度 100% → 0%: 20小时 (自然衰减)
- 水分 100% → 0%: 10小时 (自然衰减)
- 设计意图: 玩家每天至少登录1次补给

**死亡频率控制**:
- 正常游玩: 几乎不会死亡 (定期补给)
- 长期不登录: 3-5天后死亡 (提醒玩家回归)

### 4.4 付费平衡

**免费vs付费对比**:
| 功能 | 免费玩家 | 月卡玩家 ($9.99) | 通行证玩家 ($19.99) |
|------|----------|------------------|---------------------|
| 每日搜刮次数 | 20次 | 无限 | 无限 |
| 背包容量 | 100格 | 150格 | 200格 |
| 建造速度 | 正常 | 正常 | -50%时长 |
| 领地上限 | 5块 | 8块 | 10块 |
| 频道数量 | 3个 | 5个 | 无限 |

**付费优势原则**:
- **不卖战力**: 付费不能直接购买稀有资源 (只能买资源包)
- **卖便利**: 主要卖时间节省 (无限探索、建造加速)
- **卖扩展**: 更多领地、更大背包
- **不影响公平**: 免费玩家通过努力可达到同样高度

---

## 5. 用户体验设计

### 5.1 新手引导流程

**第一次启动** (预计5分钟):
```
启动游戏 → 观看30秒剧情动画 (世界观介绍)
→ 选择登录方式 → 创建角色 (昵称、头像)
→ 新手教程开始
```

**新手教程**:
1. **圈地教学** (必做):
   - NPC提示: "用双脚丈量你的第一块领地"
   - 引导玩家走出一个小圈 (最少100m²)
   - 完成后奖励: 200金币, 木材×50, 食物×30
2. **探索教学** (必做):
   - NPC: "去附近的废墟搜刮物资"
   - 引导玩家找到最近的POI并搜刮
   - 完成后奖励: 150金币, 背包讲解
3. **建造教学** (必做):
   - NPC: "建造你的第一个篝火"
   - 引导玩家打开建造菜单，建造篝火
   - 完成后奖励: 200金币, 解锁更多建筑
4. **生存教学** (选做):
   - NPC: "注意你的饱食度和水分"
   - 引导玩家使用食物和水
   - 完成后奖励: 100金币
5. **社交教学** (选做):
   - NPC: "加入公共频道，向其他开拓者问好"
   - 引导玩家打开频道，发送第一条消息
   - 完成后奖励: 150金币

**新手保护**:
- 前7天: 生存指标衰减速度 -50%
- 前3天: 建造时长 -50%
- Lv.1-5: 死亡不掉落物品

### 5.2 每日流程设计

**每日登录** (预计15-30分钟):
```
登录游戏 → 查看每日任务 → 查看生存体征 → 补充食物/水 (如需)
→ 出门探索 (搜刮POI, 圈新地) → 返回领地 → 建造/升级建筑
→ 查看交易市场 → 与其他玩家交易 → 查看排行榜 → 离开游戏
```

**每日任务** (刷新时间: 每天0点):
| 任务 | 奖励 |
|------|------|
| 搜刮5个POI | 100金币, 食物×20 |
| 探索距离达到3km | 150金币, 水×10 |
| 完成1次交易 | 200金币 |
| 使用1次食物或水 | 50金币 |
| 在频道发送3条消息 | 100金币 |

**每周任务** (刷新时间: 每周一0点):
| 任务 | 奖励 |
|------|------|
| 圈地总面积增加5000m² | 500金币, 稀有资源×5 |
| 建造3个建筑 | 600金币, 建材包 |
| 完成10次交易 | 800金币 |
| 搜刮30个POI | 700金币, 高级资源包 |

### 5.3 UI/UX设计原则

**视觉风格**:
- **希望朋克美学**:
  - 主色调: 深灰 + 青绿 (象征废土上的新生)
  - 辅助色: 暖黄 (篝火、希望)
  - 对比色: 橙红 (警告、危险)
- **末世感**:
  - 旧纸张质感的UI边框
  - 磨损、划痕的纹理
  - 手绘风格的图标
- **未来科技感**:
  - 全息投影式的地图
  - 数字化的资源计数器
  - 霓虹灯式的按钮高亮

**交互设计**:
- **手势操作**:
  - 地图: 双指缩放、单指拖动
  - 建筑放置: 拖拽图标到地图
  - PTT呼叫: 长按按钮
- **反馈设计**:
  - 按钮点击: 震动反馈 (轻微)
  - 圈地成功: 震动 + 音效 + 视觉特效
  - 资源获得: 飘字动画
  - 生命值低: 屏幕边缘发红 + 心跳音效

**信息架构**:
```
底部Tab栏 (5个):
├── 地图 (主页): 圈地、探索、领地管理
├── 资源: 背包、建造、交易
├── 通讯: 频道、PTT、消息中心
├── 成长: 排行榜、成就、每日任务
└── 个人: 档案、设置、订阅
```

### 5.4 音效与音乐

**背景音乐**:
- **主界面**: 舒缓的后摇 (Post-Rock), 传递希望感
- **探索时**: 轻快的电子乐, 鼓励行动
- **战斗时** (未来PVP): 紧张的配乐
- **夜晚模式**: 更加平静的环境音

**音效设计**:
- **圈地**:
  - 轨迹绘制: 轻微的"滋滋"声 (像绘图笔)
  - 闭合成功: "叮"声 + 欢快和弦
- **探索**:
  - 发现POI: 雷达"哔哔"声
  - 搜刮获得: 翻箱倒柜声 + 资源掉落声
- **建造**:
  - 建造开始: 锤子敲打声
  - 建造完成: 建筑"竖立"声 + 成功音效
- **社交**:
  - 收到消息: 无线电"嘶嘶"声
  - PTT呼叫: 对讲机"咔嗒"声
- **生存**:
  - 饥饿/口渴: 肚子咕咕叫 / 吞咽声
  - 生命值低: 心跳加速音效

---

## 6. 技术实现要点

### 6.1 GPS与地图技术

**定位精度优化**:
- 使用`kCLLocationAccuracyBest`获取最高精度
- GPS信号弱时降级使用WiFi/基站定位
- 多次采样平滑处理，减少漂移

**轨迹记录**:
- 每3秒记录一次位置点
- 使用Douglas-Peucker算法简化轨迹 (减少数据量)
- 轨迹点存储: 经纬度 + 时间戳 + 精度

**多边形生成**:
- 闭合检测: 终点距起点 < 50米
- 面积计算: Shoelace公式
- 重叠检测: PostGIS的`ST_Intersects`函数

**地图渲染优化**:
- 使用MapKit的原生渲染能力
- 领地多边形: `MKPolygon` + 自定义Renderer
- 建筑标记: `MKAnnotation` + 聚合 (zoom out时)

### 6.2 数据库设计 (Supabase + PostGIS)

**核心表结构**:

**users** (用户表):
```sql
CREATE TABLE users (
  id UUID PRIMARY KEY,
  username VARCHAR(50) UNIQUE,
  email VARCHAR(255),
  auth_provider VARCHAR(20), -- 'email', 'apple', 'google'
  level INT DEFAULT 1,
  experience INT DEFAULT 0,
  gold INT DEFAULT 0,
  created_at TIMESTAMP,
  last_login TIMESTAMP
);
```

**territories** (领地表):
```sql
CREATE TABLE territories (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id),
  name VARCHAR(50),
  area FLOAT, -- 面积 (平方米)
  geometry GEOGRAPHY(Polygon, 4326), -- PostGIS 地理多边形
  allow_trading BOOLEAN DEFAULT false,
  created_at TIMESTAMP,
  last_active TIMESTAMP
);

-- 空间索引加速查询
CREATE INDEX idx_territories_geom ON territories USING GIST(geometry);
```

**buildings** (建筑表):
```sql
CREATE TABLE buildings (
  id UUID PRIMARY KEY,
  territory_id UUID REFERENCES territories(id),
  template_id INT, -- 建筑模板ID
  status VARCHAR(20), -- 'building', 'idle', 'active', 'damaged'
  durability INT DEFAULT 100,
  position_lat FLOAT,
  position_lon FLOAT,
  created_at TIMESTAMP,
  completed_at TIMESTAMP
);
```

**inventory** (背包表):
```sql
CREATE TABLE inventory (
  user_id UUID REFERENCES users(id),
  item_id INT, -- 物品ID
  quantity INT,
  PRIMARY KEY (user_id, item_id)
);
```

**trades** (交易表):
```sql
CREATE TABLE trades (
  id UUID PRIMARY KEY,
  seller_id UUID REFERENCES users(id),
  buyer_id UUID,
  offer_item_id INT,
  offer_quantity INT,
  request_item_id INT,
  request_quantity INT,
  status VARCHAR(20), -- 'pending', 'completed', 'cancelled'
  created_at TIMESTAMP,
  completed_at TIMESTAMP
);
```

### 6.3 实时通讯 (Supabase Realtime)

**频道消息**:
```sql
CREATE TABLE channel_messages (
  id UUID PRIMARY KEY,
  channel_id UUID,
  user_id UUID REFERENCES users(id),
  message_type VARCHAR(10), -- 'text', 'voice'
  content TEXT, -- 文字内容 或 语音URL
  created_at TIMESTAMP
);

-- 订阅实时消息
const subscription = supabase
  .channel('channel_123')
  .on('postgres_changes',
    { event: 'INSERT', schema: 'public', table: 'channel_messages' },
    (payload) => {
      // 收到新消息，更新UI
    }
  )
  .subscribe();
```

### 6.4 防作弊机制

**GPS作弊检测**:
- **速度检测**: 移动速度 > 20 km/h 视为异常
- **轨迹一致性**: 实际距离 / 直线距离 < 1.2 视为传送作弊
- **时间合理性**: 圈地时长 < 5分钟视为异常

**服务端校验**:
- 所有重要操作 (圈地、建造、交易) 必须经过服务端验证
- 客户端只负责展示，不信任客户端数据
- 资源数量、位置坐标全部服务端计算

**异常监控**:
- 单日搜刮次数 > 50次 → 人工审核
- 单日交易次数 > 20次 → 人工审核
- 资源增长异常 (暴涨) → 封号

---

## 7. 运营与活动设计

### 7.1 日常活动

**每日签到**:
- 连续签到奖励递增
- 第7天: 稀有资源包
- 断签后重新开始

**限时探索挑战**:
- 每周末: "废墟寻宝"活动
- 特定POI掉落率 × 2
- 完成指定探索任务额外奖励

**建造竞赛**:
- 每月一次: "最美领地评选"
- 玩家提交领地截图
- 社区投票 + 官方评审
- 获奖者获得专属建筑皮肤

### 7.2 赛季系统 (未来)

**赛季周期**: 3个月

**赛季主题**:
- S1: "废墟重生" - 主打探索和建造
- S2: "联盟纷争" - 加入联盟系统和竞技
- S3: "科技复兴" - 加入高科技建筑和新资源

**赛季通行证**:
- 免费通行证: 基础奖励
- 付费通行证 ($9.99): 豪华奖励 + 专属皮肤
- 升级方式: 完成赛季任务获得赛季经验

### 7.3 社区运营

**官方内容**:
- 每周开发日志 (透明化开发进度)
- 玩家故事专栏 (采访优秀玩家)
- 攻略Wiki (官方+社区共建)

**UGC激励**:
- 鼓励玩家分享探索故事
- 优秀内容官方转发并奖励
- 建立玩家创作者计划

**客服与反馈**:
- Discord社区 24/7
- 游戏内反馈入口 (一键提交Bug)
- 每月玩家调研问卷

---

## 8. 商业化与变现

### 8.1 变现策略

**订阅制** (核心):
- 重点推广月卡和通行证
- 提供"首月半价"吸引转化
- 强调性价比 (月卡 vs 单次购买)

**资源包** (补充):
- 低价引导 ($0.99): 降低付费门槛
- 每日限购包: 制造稀缺感和紧迫感
- 节假日礼包: 节日营销

**广告变现** (辅助):
- 激励视频广告:
  - 观看广告获得 "探索增益" (1小时内掉落+20%)
  - 观看广告 "建造加速" (减少10%时长)
- 不干扰核心体验 (不强制看广告)

### 8.2 付费点设计

**痛点付费** (玩家遇到困难时):
- 背包满了 → 售卖"背包扩容"或"仓库"
- 建造时间长 → 售卖"加速卡"
- 资源不够 → 售卖"资源包"

**炫耀付费** (满足虚荣心):
- 专属建筑皮肤 (月卡/通行证)
- 领地装饰物
- 聊天气泡、专属称号

**便利付费** (节省时间):
- 无限探索 (月卡)
- 自动收集产出 (通行证)

### 8.3 付费转化漏斗

```
新用户注册 (100%)
  ↓
完成新手教程 (70%)
  ↓
体验核心玩法 (50%)
  ↓
遇到付费点 (背包满/建造慢) (30%)
  ↓
首次付费 ($0.99小额) (8%)
  ↓
成为月卡用户 (5%)
  ↓
成为通行证用户 (2%)
```

**转化优化**:
- 在合适时机弹出"限时优惠"
- 展示付费用户的优势 (对比表)
- 提供"试用"体验 (赠送1天VIP体验)

---

## 9. 风险与挑战

### 9.1 技术风险

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| GPS定位不准确 | 高 | 高 | 多重定位源、算法优化、用户反馈调优 |
| 服务器成本超预算 | 中 | 中 | Supabase按需付费、优化查询、缓存 |
| 地图API限制 | 低 | 高 | 使用免费的Apple MapKit |
| 作弊行为泛滥 | 中 | 高 | 服务端校验、异常检测、人工审核 |

### 9.2 市场风险

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| 用户留存率低 | 中 | 高 | 强化社交、生存机制、每日任务 |
| 付费转化率低 | 中 | 高 | 优化付费点、提供试用、A/B测试 |
| 竞品抄袭 | 高 | 中 | 快速迭代、建立品牌、社区运营 |
| 季节性波动 | 中 | 中 | 室内活动 (未来)、冬季特别活动 |

### 9.3 合规风险

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| 隐私法规 (GDPR) | 低 | 高 | 隐私设置、数据脱敏、合规审查 |
| 未成年人保护 | 低 | 中 | 实名认证、防沉迷系统 |
| 地图数据使用 | 低 | 中 | 使用官方API、遵守ToS |

---

## 10. 未来规划

### 10.1 短期规划 (3个月)

**功能迭代**:
- 新建筑: 雷达站 (扫描附近玩家)、交易所 (自动匹配交易)
- 新资源: 电子货币 (稀有)、化学原料
- 新POI类型: 学校 (书籍)、体育馆 (装备)

**系统优化**:
- GPS定位精度提升
- 地图加载速度优化
- 服务器性能调优

**活动上线**:
- 每周探索挑战
- 月度建造竞赛
- 节假日限时活动

### 10.2 中期规划 (6个月)

**大版本更新**:
- **联盟系统**:
  - 玩家组建联盟 (最多50人)
  - 联盟领地 (多人共同圈地)
  - 联盟建筑 (需协作建造)
  - 联盟战争 (未来)
- **PVP竞技场**:
  - 资源争夺战
  - 排名赛 (每周结算)
  - 专属奖励

**新地图**:
- 主题地图: 沙漠、森林、雪原 (不同环境不同资源)
- 特殊区域: 辐射区 (高风险高收益)

### 10.3 长期规划 (1年+)

**剧情模式**:
- 主线任务: 探索世界战争的真相
- 支线任务: NPC委托、区域故事
- 剧情选择: 影响游戏结局

**跨平台**:
- Android版本开发
- Web端 (有限功能)

**全球化**:
- 多语言支持 (日、韩、西、法、德)
- 全球服务器 (分区运营)
- 本地化运营 (不同地区不同活动)

**IP扩展**:
- 周边商品 (T恤、徽章)
- 漫画/小说 (世界观扩展)
- 线下活动 (城市定向赛)

---

## 11. 附录

### 11.1 参考游戏

**核心玩法参考**:
- 《宝可梦GO》: LBS探索、GPS玩法
- 《Ingress》: 地理占领、阵营对抗
- 《饥荒》: 生存体征、资源管理
- 《辐射:避难所》: 建造管理、末世主题

**商业化参考**:
- 《王者荣耀》: 订阅制 (月卡)
- 《原神》: 赛季通行证
- 《部落冲突》: 建造加速、资源包

### 11.2 技术文档

- Apple MapKit: https://developer.apple.com/documentation/mapkit
- CoreLocation: https://developer.apple.com/documentation/corelocation
- Supabase: https://supabase.com/docs
- PostGIS: https://postgis.net/documentation/
- StoreKit 2: https://developer.apple.com/documentation/storekit

### 11.3 设计工具

- **原型设计**: Figma
- **数据平衡**: Excel / Google Sheets
- **关卡设计**: 自定义JSON配置
- **地图编辑**: QGIS (地理信息系统)

---

**文档结束**

*这是一个充满希望的世界，每一步都是在重建文明。*
*欢迎来到地球新主的世界，开拓者！*
