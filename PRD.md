# 产品需求文档 (PRD)
## 《地球新主》(EarthBuilder)

---

## 文档信息
- **产品名称**: 地球新主 (EarthBuilder)
- **产品类型**: 末世生存 LBS 游戏
- **平台**: iOS
- **目标市场**: 全球市场 (支持多语言)
- **文档版本**: v1.0
- **最后更新**: 2026-01-03

---

## 1. 产品概述

### 1.1 产品定位
《地球新主》是一款基于真实地理位置的末世生存游戏，结合了 GPS 圈地、探索收集、建造管理和社交交易等核心玩法。玩家通过真实世界的移动来圈占领地、探索废墟、搜刮资源，并在自己的领地上建造设施，与其他玩家交易互动，共同重建末世文明。

### 1.2 产品愿景
创造一个将虚拟游戏与真实世界深度融合的创新体验，鼓励玩家走出户外、探索城市，在游戏中体验末世求生的紧张刺激和重建家园的成就感。

### 1.3 核心价值主张
- **Walk to Earn**: 走路即赚取资源，将现实运动转化为游戏奖励
- **真实地理融合**: 利用真实地标和地理位置增强沉浸感
- **社交互动**: 基于位置的社交、交易和通讯系统
- **策略深度**: 资源管理、建造规划、生存体征等硬核机制
- **希望朋克美学**: 废土之上的新生与希望，正能量的末世叙事

### 1.4 竞品对比
| 特性 | 地球新主 | 宝可梦GO | Ingress |
|------|----------|----------|---------|
| 圈地玩法 | ✅ 核心玩法 | ❌ | ✅ 区域控制 |
| 真实地标探索 | ✅ | ✅ | ✅ |
| 资源收集 | ✅ | ✅ (宝可球) | ❌ |
| 建造系统 | ✅ | ❌ | ❌ |
| 生存机制 | ✅ | ❌ | ❌ |
| 社交交易 | ✅ | ⚠️ 有限 | ⚠️ 有限 |
| 付费模式 | 订阅+资源包 | 道具内购 | 免费 |

---

## 2. 目标用户

### 2.1 核心用户画像

**主要用户群体 1: 运动爱好者 (25-35岁)**
- **需求**: 希望通过游戏激励自己多走路运动
- **痛点**: 单纯运动APP缺乏趣味性
- **吸引点**: Walk to Earn 机制，运动有实际游戏收益

**主要用户群体 2: 策略游戏玩家 (18-30岁)**
- **需求**: 喜欢资源管理、建造、策略规划
- **痛点**: 传统手游缺乏真实世界互动
- **吸引点**: 复杂的资源系统、建造系统、生存机制

**主要用户群体 3: 社交游戏玩家 (20-40岁)**
- **需求**: 通过游戏认识附近的人，建立社交圈
- **痛点**: 普通社交APP缺乏破冰场景
- **吸引点**: 基于位置的频道、交易、PTT呼叫

### 2.2 用户规模预期
- **第一年目标**: 10万注册用户
- **付费用户转化率**: 5-8%
- **日活跃用户(DAU)**: 20-30%
- **月活跃用户(MAU)**: 50-60%

---

## 3. 核心功能需求

### 3.1 功能架构图

```
地球新主
├── 用户系统
│   ├── 登录注册 (邮箱/Apple/Google)
│   ├── 个人主页
│   └── 多语言设置
├── 地图与领地系统
│   ├── GPS 圈地
│   ├── 领地管理
│   └── 卫星地图展示
├── 探索与资源系统
│   ├── POI 发现与搜刮
│   ├── 背包管理
│   └── 资源分类
├── 建造与发展系统
│   ├── 建筑建造
│   ├── 建筑状态管理
│   └── 建筑升级
├── 交易系统
│   ├── 挂单发布
│   ├── 交易匹配
│   └── 位置限制 (100米内可见)
├── 通讯系统
│   ├── 消息中心
│   ├── 公共频道 (3km范围)
│   ├── 频道管理
│   ├── PTT 呼叫
│   └── 设备等级
├── 成长系统
│   ├── 等级系统
│   ├── 成就系统
│   ├── 排行榜
│   └── 生存体征
└── 商业化系统
    ├── 订阅制 (月卡)
    └── 一次性购买 (资源包)
```

### 3.2 详细功能需求

#### 3.2.1 登录注册系统 (P0)
**功能描述**: 用户身份认证和账号管理

**需求细节**:
- 支持邮箱注册 (用户名+密码)
- 支持 Apple 登录 (OAuth)
- 支持 Google 登录 (OAuth)
- 邮箱验证功能
- 密码重置功能
- 多设备登录支持
- 会话管理 (自动登录)

**技术实现**: Supabase Auth

**成功指标**:
- 注册转化率 > 60%
- OAuth登录占比 > 70%
- 登录成功率 > 99%

---

#### 3.2.2 GPS 圈地系统 (P0)
**功能描述**: 核心玩法，通过GPS轨迹圈占领地

**需求细节**:
- 实时GPS定位和轨迹记录
- 轨迹可视化 (蓝色线条)
- 自动闭合检测 (回到起点附近)
- 多边形生成和面积计算
- 合法性检查:
  - 防作弊检测 (速度异常、轨迹异常)
  - 重叠检测 (与其他玩家领地)
  - 最小面积限制
- 领地确认和保存

**技术实现**:
- MapKit (地图展示)
- CoreLocation (GPS定位)
- PostGIS (地理空间数据存储)

**成功指标**:
- 圈地成功率 > 85%
- 作弊拦截率 > 95%
- GPS定位精度 < 10米

---

#### 3.2.3 领地管理系统 (P0)
**功能描述**: 查看和管理已拥有的领地

**需求细节**:
- 领地列表展示
- 领地详情:
  - 名称 (可自定义)
  - 面积
  - 建筑数量
  - 创建时间
- 允许交易开关
- 领地回收机制:
  - 30天内必须开始建设
  - 90天内保持活跃

**数据存储**: Supabase + PostGIS

**成功指标**:
- 领地活跃率 > 60%
- 交易开放率 > 40%

---

#### 3.2.4 POI 发现与搜刮系统 (P0)
**功能描述**: 探索真实地标获取资源

**需求细节**:
- 自动检测附近 POI (兴趣点)
- POI 分类:
  - 医院/药店 → 药品
  - 超市/餐厅 → 食物
  - 工厂/工地 → 金属
  - 公园/林地 → 木材
  - 银行/珠宝店 → 稀有材料
- 地理围栏触发 (进入范围自动提示)
- 搜刮操作:
  - 单次搜刮
  - 资源随机掉落 (基于 POI 类型)
  - 冷却时间 (同一POI 24小时内只能搜刮一次)
- 探索成就记录:
  - 距离
  - 时长
  - 获得物品

**技术实现**:
- MapKit Local Search (POI 数据)
- 地理围栏 (Geofencing)

**成功指标**:
- POI 识别准确率 > 90%
- 平均每用户每周搜刮次数 > 10

---

#### 3.2.5 背包系统 (P0)
**功能描述**: 物品存储和管理

**需求细节**:
- 背包容量限制 (默认100格)
- 物品分类:
  - 食物 (罐头、饮用水)
  - 药品 (急救包、抗生素)
  - 材料 (木材、金属、石头、布料)
  - 稀有材料
- 物品数量显示
- 容量提示 (已用/总容量)
- 物品使用功能
- 本地优先架构 (离线可用)

**数据存储**: 本地 + 云端同步

**成功指标**:
- 背包满载率 < 30% (避免用户弃玩)
- 同步成功率 > 99%

---

#### 3.2.6 建造系统 (P0)
**功能描述**: 在领地上建造建筑

**需求细节**:
- 建筑分类:
  - 生存类: 篝火、庇护所
  - 储存类: 小仓库、中仓库、大仓库
  - 生产类: 农田、工作台
  - 能源类: 太阳能板、风力发电机
- 建筑等级: Tier 1 / Tier 2 / Tier 3
- 建造流程:
  1. 选择建筑
  2. 检查资源是否充足
  3. 选择建造位置 (拖拽图标)
  4. 确认建造
  5. 扣除资源
  6. 建筑进入"建造中"状态
- 建造时间 (可通过付费加速)
- 建筑数量限制 (根据领地面积)

**成功指标**:
- 建造成功率 > 90%
- 平均每领地建筑数 > 3

---

#### 3.2.7 建筑状态管理 (P1)
**功能描述**: 建筑生命周期管理

**需求细节**:
- 建筑状态机:
  - 建造中 → 待激活 → 运行中 → 损坏 → 维修中
- 状态转换规则:
  - 建造完成 → 待激活
  - 激活后 → 运行中
  - 时间衰减 → 损坏
  - 维修后 → 运行中
- 建筑操作:
  - 激活 (仅待激活状态)
  - 升级 (仅运行中状态)
  - 维修 (仅损坏状态)
  - 拆除 (任何状态)
- 建筑维护:
  - 定期消耗资源
  - 损坏后停止功能

**成功指标**:
- 建筑损坏率 < 20%
- 维修及时率 > 70%

---

#### 3.2.8 交易系统 (P1)
**功能描述**: 玩家间物品交易

**需求细节**:
- 挂单发布:
  - 我提供 (物品+数量)
  - 我需要 (物品+数量)
- 交易匹配:
  - 基于位置 (100米内可见对方挂单)
  - 需要领地开启"允许交易"
- 交易流程:
  1. A发布挂单
  2. B进入A领地100米内
  3. B看到A的挂单
  4. B接受交易
  5. 系统自动扣除和发放物品
- 交易记录
- 取消挂单功能

**成功指标**:
- 交易成功率 > 50%
- 平均每用户每周交易次数 > 2

---

#### 3.2.9 消息中心 (P1)
**功能描述**: 系统消息推送

**需求细节**:
- 消息分类:
  - 官方消息 (公告、活动)
  - 生存指南 (新手教程)
  - 每日任务
  - 交易通知
  - 系统通知
- 消息展示:
  - 标题
  - 内容
  - 时间
  - 已读/未读状态
- 消息推送 (本地通知)

**成功指标**:
- 消息打开率 > 30%
- 推送到达率 > 95%

---

#### 3.2.10 公共频道聊天 (P1)
**功能描述**: 基于位置的公共聊天

**需求细节**:
- 覆盖范围: 3km (可通过设备升级扩大)
- 实时消息 (Supabase Realtime)
- 消息展示:
  - 发送者昵称
  - 消息内容
  - 发送时间
- 消息输入和发送
- 自动刷新

**技术实现**: Supabase Realtime

**成功指标**:
- 频道日活跃率 > 25%
- 平均每用户每天发言 > 3条

---

#### 3.2.11 频道管理 (P1)
**功能描述**: 创建和加入主题频道

**需求细节**:
- 频道创建:
  - 频道名称
  - 频道描述
  - 位置绑定 (可选)
- 频道列表:
  - 显示频道名、距离、在线人数
  - 按距离排序
- 加入/退出频道
- 频道聊天 (与公共频道类似)

**成功指标**:
- 用户加入频道数 > 2
- 自建频道占比 > 15%

---

#### 3.2.12 PTT 呼叫 (P2)
**功能描述**: 对讲机式语音呼叫

**需求细节**:
- PTT (Push to Talk) 交互:
  - 长按按钮录音
  - 松开发送
- 频率选择 (公共频道/私人频道)
- 覆盖范围限制 (根据设备等级)
- 语音消息播放

**技术实现**: 语音录制和播放 API

**成功指标**:
- PTT使用率 > 10%
- 语音消息成功率 > 95%

---

#### 3.2.13 设备等级系统 (P1)
**功能描述**: 通讯设备升级

**需求细节**:
- 设备等级:
  - 收音机 (初始): 只能接收，不能发送
  - 对讲机: 收发，3km范围
  - 营地电台: 收发，10km范围
  - 卫星通讯: 收发，全球范围
- 升级条件:
  - 消耗资源
  - 等级要求
- 功能解锁:
  - 发送消息
  - 扩大范围
  - 更多频道

**商业化**: 可付费加速升级

**成功指标**:
- 设备升级率 > 40%
- 付费升级占比 > 20%

---

#### 3.2.14 个人主页 (P0)
**功能描述**: 玩家档案和成就展示

**需求细节**:
- 基础信息:
  - 昵称
  - 头像
  - 开拓者等级
  - 存活天数
- 成就数据:
  - 领地数量
  - 总面积
  - 建筑数量
  - 探索次数
- 设置入口:
  - 语言设置
  - 通知设置
  - 隐私设置
  - 账号管理

**成功指标**:
- 个人主页访问频率 > 2次/周

---

#### 3.2.15 多语言系统 (P0)
**功能描述**: 支持多种语言

**需求细节**:
- 支持语言:
  - 简体中文
  - 繁体中文
  - English
  - 日本語 (未来)
  - 한국어 (未来)
- 动态切换
- 重启应用生效
- 本地化内容:
  - UI文本
  - 系统消息
  - 建筑名称
  - 物品名称

**成功指标**:
- 海外用户占比 > 30%

---

#### 3.2.16 付费订阅系统 (P0)
**功能描述**: 商业化核心功能

**需求细节**:
- **订阅制**:
  - 开拓者月卡 ($9.99/月):
    - 无限探索次数
    - POI搜刮范围扩大
    - 背包容量+50
  - 领主通行证 ($19.99/月):
    - 月卡所有特权
    - 建造时间减半
    - 设备升级折扣
    - 专属建筑皮肤
- **一次性购买** (资源包):
  - 初级物资包 ($0.99): 食物×50, 木材×30
  - 中级物资包 ($2.99): 食物×150, 金属×50, 药品×30
  - 高级物资包 ($4.99): 稀有材料×10, 全资源包
  - 稀有资源包 ($9.99): 卫星模块×5, 高级材料×20
- StoreKit 2 集成
- 订阅自动续费
- 家庭共享支持
- 退款处理

**成功指标**:
- 付费用户转化率 > 5%
- ARPPU (付费用户平均收入) > $15/月

---

#### 3.2.17 排行榜系统 (P1)
**功能描述**: 竞争与激励

**需求细节**:
- 榜单分类:
  - 领地面积榜 (Top 100)
  - 探索废墟榜 (搜刮次数)
  - 建筑数量榜
- 榜单更新: 5分钟刷新一次
- 个人排名显示
- 查看他人档案

**技术实现**:
- 数据库窗口函数
- 缓存机制

**成功指标**:
- 排行榜查看率 > 40%
- 榜单竞争带来的活跃提升 > 15%

---

#### 3.2.18 成就系统 (P1)
**功能描述**: 新手引导和长期目标

**需求细节**:
- 成就分类:
  - 新手成就 (引导性):
    - 完成第一次圈地
    - 完成第一次搜刮
    - 建造第一个建筑
  - 进阶成就:
    - 圈地总面积达到10000m²
    - 搜刮100次
    - 建造10个建筑
  - 稀有成就:
    - 单次圈地面积超过50000m²
    - 连续登录30天
    - 交易100次
- 成就奖励: 金币
- 稀有度: 普通 / 稀有 / 史诗 / 传说
- 完成度展示

**技术实现**: EventBus (事件总线)

**成功指标**:
- 新手成就完成率 > 80%
- 成就系统带来的留存提升 > 20%

---

#### 3.2.19 生存体征系统 (P2)
**功能描述**: 硬核生存机制

**需求细节**:
- 生存指标:
  - 核心生命 (0-100)
  - 饱食度 (0-100%)
  - 水分 (0-100%)
- 时间衰减:
  - 饱食度: -5/小时
  - 水分: -10/小时
- 低于阈值的惩罚:
  - 饱食度/水分 < 30%: 生命值下降
  - 生命值降至0: 角色死亡 (损失部分资源)
- 增益机制:
  - 饱食度/水分 > 80%: 探索收益+20%
- 补给方式:
  - 使用食物/水恢复
  - 在庇护所自动恢复

**商业化**: 卖"速效补给包"

**成功指标**:
- 生存体征互动率 > 60%
- 补给道具购买率 > 15%

---

## 4. 技术需求

### 4.1 技术架构

**前端**:
- **平台**: iOS (Swift, SwiftUI)
- **最低版本**: iOS 15.0+
- **开发工具**: Xcode 14+

**后端服务**:
- **BaaS**: Supabase
  - 认证 (Auth)
  - 数据库 (PostgreSQL + PostGIS)
  - 实时通讯 (Realtime)
  - 存储 (Storage)

**核心技术栈**:
- **地图**: Apple MapKit
- **定位**: CoreLocation
- **支付**: StoreKit 2
- **本地存储**: SwiftData / Core Data
- **网络**: URLSession / Supabase SDK

### 4.2 性能需求

| 指标 | 目标值 |
|------|--------|
| 应用启动时间 | < 2秒 |
| GPS定位响应 | < 1秒 |
| 地图加载时间 | < 3秒 |
| 数据同步延迟 | < 500ms |
| 聊天消息延迟 | < 200ms |
| 崩溃率 | < 0.5% |
| 内存占用 | < 200MB |

### 4.3 安全需求

- **数据加密**:
  - 传输层加密 (HTTPS/TLS)
  - 敏感数据本地加密
- **防作弊**:
  - GPS轨迹异常检测
  - 速度异常拦截
  - 服务端数据校验
- **隐私保护**:
  - 用户位置数据脱敏
  - 符合GDPR/CCPA要求
  - 隐私政策和用户协议

### 4.4 扩展性需求

- 支持10万并发用户
- 数据库查询响应 < 100ms (99分位)
- 水平扩展能力 (Supabase自动扩展)

---

## 5. 商业化策略

### 5.1 变现模式

**主要收入来源**:
1. **订阅制** (预计占比 60%):
   - 开拓者月卡 $9.99/月
   - 领主通行证 $19.99/月
2. **资源包** (预计占比 30%):
   - $0.99 - $9.99 不等
3. **广告** (预计占比 10%):
   - 激励视频广告 (观看获得资源)

### 5.2 定价策略

- **低门槛**: $0.99起步的资源包吸引首次付费
- **订阅优势**: 月卡性价比高于单次购买
- **限时优惠**: 新用户首月半价

### 5.3 收入预测 (第一年)

| 月份 | 注册用户 | 付费用户 | 月收入 (USD) |
|------|----------|----------|--------------|
| M1-M3 | 5,000 | 250 | $3,750 |
| M4-M6 | 15,000 | 900 | $13,500 |
| M7-M9 | 30,000 | 2,100 | $31,500 |
| M10-M12 | 50,000 | 4,000 | $60,000 |
| **总计** | **100,000** | **7,250** | **$108,750** |

*假设: 付费率5%, ARPPU $15/月*

---

## 6. 运营策略

### 6.1 增长策略

**获客渠道**:
- App Store ASO 优化
- 社交媒体营销 (TikTok, Instagram, YouTube)
- KOL合作 (户外/运动/游戏领域)
- 病毒式传播 (邀请奖励)

**留存策略**:
- 每日任务和签到奖励
- 定期活动 (探索挑战、建造竞赛)
- 社交绑定 (频道、交易)
- 生存体征机制 (必须定期登录)

### 6.2 内容更新计划

**短期 (前3个月)**:
- 新建筑和资源
- 限时活动
- Bug修复和优化

**中期 (3-6个月)**:
- 联盟系统 (玩家组队)
- PVP竞技场
- 更多POI类型

**长期 (6-12个月)**:
- 新地图 (不同城市主题)
- 剧情任务线
- 赛季系统

### 6.3 社区建设

- 官方Discord服务器
- 玩家攻略Wiki
- 用户反馈论坛
- 定期直播和Q&A

---

## 7. 成功指标 (KPI)

### 7.1 核心指标

| 指标 | 定义 | 目标值 (6个月) |
|------|------|----------------|
| DAU | 日活跃用户 | 20,000 |
| MAU | 月活跃用户 | 60,000 |
| 留存率 (次日) | 次日仍登录的用户比例 | > 40% |
| 留存率 (7日) | 7天后仍登录的用户比例 | > 20% |
| 留存率 (30日) | 30天后仍登录的用户比例 | > 10% |
| 付费转化率 | 付费用户/总用户 | > 5% |
| ARPU | 平均每用户收入 | > $0.75/月 |
| ARPPU | 付费用户平均收入 | > $15/月 |

### 7.2 功能指标

| 功能 | 指标 | 目标值 |
|------|------|--------|
| 圈地 | 平均每用户领地数 | > 2 |
| 探索 | 平均每周搜刮次数 | > 10 |
| 建造 | 平均每领地建筑数 | > 3 |
| 交易 | 平均每周交易次数 | > 2 |
| 社交 | 频道参与率 | > 30% |

---

## 8. 风险与挑战

### 8.1 技术风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| GPS定位不准确 | 圈地体验差 | 多重定位校验，算法优化 |
| 服务器宕机 | 用户无法游玩 | Supabase高可用，本地缓存 |
| 作弊行为 | 游戏公平性 | 服务端校验，异常检测 |

### 8.2 市场风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 用户获取成本高 | 盈利困难 | 病毒式传播，降低CAC |
| 留存率低 | MAU下降 | 强化社交和生存机制 |
| 竞品抄袭 | 市场份额 | 快速迭代，建立品牌 |

### 8.3 法律风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 隐私法规 (GDPR) | 无法在欧洲运营 | 隐私设置，合规审查 |
| 地理数据使用 | 法律纠纷 | 使用官方API，遵守ToS |

---

## 9. 开发计划

### 9.1 开发里程碑

| 阶段 | 时间 | 交付内容 |
|------|------|----------|
| Alpha | Week 1-3 | 核心功能 (登录、圈地、探索、建造) |
| Beta | Week 4-6 | 完整功能 (社交、交易、付费) |
| 测试 | Week 7-8 | Bug修复、性能优化、压力测试 |
| 上线 | Week 9 | App Store提交审核 |
| 运营 | Week 10+ | 数据监控、内容更新、用户支持 |

### 9.2 团队配置

| 角色 | 人数 | 职责 |
|------|------|------|
| 产品经理 | 1 | 需求管理、优先级 |
| iOS开发 | 1-2 | 前端开发 |
| 后端开发 | 1 | Supabase配置、API |
| UI/UX设计师 | 1 | 界面设计、交互 |
| 测试工程师 | 1 | 功能测试、性能测试 |
| 运营 | 1 | 用户增长、社区管理 |

*注: 本项目原型为1人使用AI工具在3周内完成*

---

## 10. 附录

### 10.1 术语表

- **LBS**: Location-Based Service，基于位置的服务
- **POI**: Point of Interest，兴趣点
- **PTT**: Push to Talk，一键通话
- **OAuth**: 开放授权标准
- **BaaS**: Backend as a Service，后端即服务
- **PostGIS**: PostgreSQL地理空间数据库扩展
- **DAU/MAU**: Daily/Monthly Active Users，日/月活跃用户
- **ARPU/ARPPU**: Average Revenue Per (Paying) User，(付费)用户平均收入

### 10.2 参考资料

- Apple MapKit文档: https://developer.apple.com/documentation/mapkit
- Supabase文档: https://supabase.com/docs
- StoreKit 2文档: https://developer.apple.com/documentation/storekit
- 宝可梦GO案例分析
- Ingress游戏设计分析

---

**文档结束**
